# Ojaman

WebRTC を用いたビデオ会話で、自分の話している時間を計測して、設定値よりも長く話した場合に設定された任意の動画をビデオ会話に差し込む Chrome 拡張です。

## ビルド方法

拡張機能を使うには、ソースコードをビルドする必要があります。

先ず初めに、このリポジトリをクローンして以下のコマンドを実行してください。

```
$> yarn install
```

次に、ビルドコマンドを実行してビルドします。ビルドファイルは `./build` に出力されます。

```
# 本番用
$> yarn build:prod

# 開発用
$> yarn build:dev

# 開発用( ファイル監視 )
$> yarn build:dev --watch
```

## 拡張機能のインストール

※ 現在、Chrome 拡張のみ対応しているため Chrome のインストール方法のみ記載しています。

`chrome://extensions/` にアクセスして、以下の画像のようにディベロッパーモードからパッケージ化されてない拡張機能を読み込むをクリックして、ビルドした `manifest.json` が含まれるフォルダー(`./build`)を読み込んでください。

![Chrome拡張のインストール方法を解説した画像](https://user-images.githubusercontent.com/46495635/145091624-e9bbae90-6139-452b-9dae-873e42b37a45.png)

読み込みが完了すると、以下の画像のようにインストールした拡張が表示されます。

![image](https://user-images.githubusercontent.com/46495635/145091908-2810614d-7b56-4fc8-8b58-468348703b72.png)

## 使用方法

### サンプルアプリ

`./example/sample-apps` にサンプルアプリがありますので、そちらで基本的な動作を確認することができます。

以下のコマンドを実行する事で、アプリを起動できます。

```
# フォルダーへ移動
$> cd ./exmaples/sample-apps

# 必要なモジュールをインストール
$> yarn install

# サンプルアプリを起動する
$> yarn start
```

上記のコマンドを実行して、`http://localhost:3000` にアクセスするとサンプルアプリを開くことができます。

![image](https://user-images.githubusercontent.com/46495635/145092739-affd818f-05ec-4c67-a751-69da84298ae6.png)

**※ 拡張をインストールして無い場合は、右のポップアップは表示されません。**

上記の画面が表示されましたら、同じ URL を別タブか別ブラウザで開き、以下の動作を行います。

1. `Start Live` ボタンを押す(別で開いているモノも同様に行う)
2. `Offer` の video タグにカメラの映像が移っていれば OK
3. 映像が反映されているのを確認したのち、開いているどちらか片方の `Send Offer` ボタンを押す
4. `Answer` の video タグにもう一方のカメラ情報が移っていれば OK
5. 通信が出来ている事を確認した後、右のポップアップのヘッダーのトグルボタンを ON にする(背景が緑になります) 。
6. ポップアップのフォームから差し込みたい動画を選択する

以上の手順を踏めば、後は適当にしゃべれば動画が勝手に差し込まれます。

#### 備考

- しゃべれる時間の長さは、ポップアップの`話せる時間`のフォームから変更できます(デフォルトは 3 秒です)。
- `猶予時間`は、話しが途切れてもタイマーを止めない為の猶予時間です。**この時間が長ければ長いほど、間隔をあけて話しても話した時間としてカウントされます。**
- 設定した動画は、動画の右上にある`✖`ボタンをクリックすると設定を解除できます。

### Google Meet

[Google Meet](https://apps.google.com/intl/ja/meet/) にアクセスして会議を開始し、サンプルアプリの時と同様のポップアップの操作をして下さい。

**注意**

**この拡張を使うと、Google Meet がバグる可能性があります。**
この拡張を使って何か不利益が生じたとしても、製作者は一切責任を負いませんので、使用する際は自己責任でお願いします。

# ライセンス

[MIT](LICENCE "LICENCE")
